!function(a){var b=function(b,c){var d=this,e=a(b),f=a(".queue",e),g=a(".queue > li"),h=[],i={},j={},k={initialized:!1,playing:!1,busy:!1,count:0,index:{active:1,previous:1},viewport:{width:a(window).width()}},l=a.extend({},a.fn.queueSlider.defaults,c),m=function(){k.initialized||(f=a(".queue",e),g=a(".queue > li"),k.count=g.length,k.count>1&&(j.available=function(){var a=document.createElement("div"),b=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var c in b)if(void 0!==a.style[b[c]])return j.vendor_prefix="-"+b[c].replace("Perspective","").toLowerCase(),j.transform=j.vendor_prefix+"-transform",j.transform_duration=j.vendor_prefix+"-transition-duration",!0;return!1}(),l.touchEnabled&&x(),f.prepend(g.last().clone().addClass("qs-clone")),f.append(g.first().clone().removeClass("active").addClass("qs-clone")),g=a(".queue > li"),k.count=g.length,f.data("origStyle",f.attr("style")),g.each(function(){a(this).data("origStyle",a(this).attr("style"))}),p(),v(-o(),"reset",0),l.autoHeight&&(f.css("overflow","hidden"),q()),-1!==l.fade&&g.not(":eq(1)").children("img").fadeTo(0,l.fade),l.buttons&&(e.append('<button class="qs-previous" rel="-1">'+l.previous+'</button><button class="qs-next" rel="1">'+l.next+"</button>"),a("button",e).bind("click.queueSlider",function(){return k.busy||(k.busy=!0,clearInterval(k.play),r(parseInt(a(this).attr("rel"),10))),!1})),0!==l.speed&&(k.play=setInterval(function(){k.busy||(k.busy=!0,r(l.direction))},l.speed)),a(window).bind("resize.queueSlider",n)),k.initialized=!0)},n=function(){k.busy=!0,k.viewport.width=a(window).width(),p(),q(),v(-o(),"reset",0),k.busy=!1},o=function(){var a=0,b=0;switch(l.alignMode){case"center":b=(k.viewport.width-h[k.index.active].w)/-2;break;case"right":b=k.viewport.width-h[k.index.active].w}for(a=0;a<k.index.active;a++)b+=h[a].w;return b},p=function(){var b,c=0;g.each(function(d){var e=a(this);if(l.offScreen){void 0===a(this).data("origStyle")?e.removeAttr("style"):e.attr("style",a(this).data("origStyle"));var f=e.outerWidth(!0),g=k.viewport.width-f;h[d]={w:f+(g>0?g:0)},c+=h[d].w,e.css("width",h[d].w+"px")}else h[d]={w:e.outerWidth(!0)},c+=h[d].w;b&&(h[d-1].h=b.outerHeight(!0)),b=e}),b&&(h[k.count-1].h=b.outerHeight(!0)),f.css("width",c)},q=function(){l.autoHeight&&(e.css("height",h[k.index.active].h),f.stop().animate({height:h[k.index.active].h},Math.floor(l.transitionSpeed/3)))},r=function(a){k.index.active+=a,k.index.active<0?k.index.active=k.count-1:k.index.active>=k.count&&(k.index.active=0),t()},s=function(a){a>=k.count||0>a||(k.index.active=a,t())},t=function(){e.trigger("slideStart",k.index.active),q(),u(k.index.active,k.index.previous),v(-o(),"slide")},u=function(a,b,c){-1!==l.fade&&(c=void 0===c?l.transitionSpeed:c,g.eq(a).addClass("active").children("img").fadeTo(c,1),g.eq(b).removeClass("active").children("img").fadeTo(c,l.fade))},v=function(a,b,c){if(j.available){c=void 0!==c?c:l.transitionSpeed/1e3;var d={};d[j.transform_duration]=c+"s",d[j.transform]="translate3d("+a+"px, 0, 0)",f.css(d),"slide"===b&&setTimeout(function(){k.busy&&w()},1e3*c+1)}else"slide"===b?f.animate({left:a},{duration:l.transitionSpeed,complete:w}):f.css("left",a)},w=function(){k.index.active===k.count-1?(k.index.active=1,u(1,k.count-1,0),v(-o(),"reset",0)):0===k.index.active&&(k.index.active=k.count-2,u(k.count-2,0,0),v(-o(),"reset",0)),k.index.previous=k.index.active,k.busy=!1,e.trigger("slideEnd",k.index.active)},x=function(){i={start:{x:0,y:0},end:{x:0,y:0}},e.bind("touchstart.queueSlider",y)},y=function(a){k.busy?a.preventDefault():(i.original_position=f.position(),i.start.x=a.originalEvent.changedTouches[0].pageX,i.start.y=a.originalEvent.changedTouches[0].pageY,e.bind("touchmove.queueSlider",z),e.bind("touchend.queueSlider",A))},z=function(a){var b=Math.abs(a.originalEvent.changedTouches[0].pageX-i.start.x),c=Math.abs(a.originalEvent.changedTouches[0].pageY-i.start.y),d=a.originalEvent.changedTouches[0].pageX-i.start.x;3*b>c&&a.preventDefault(),v(i.original_position.left+d,"reset",0)},A=function(a){e.unbind("touchmove.queueSlider"),i.end.x=a.originalEvent.changedTouches[0].pageX,i.end.y=a.originalEvent.changedTouches[0].pageY;var b=i.end.x-i.start.x;Math.abs(b)>=l.swipeThreshold?0>b?d.nextSlide():d.previousSlide():v(i.original_position.left,"reset",0),e.unbind("touchend.queueSlider")};return d.getState=function(a){var b,c=k,d=a.split(".");for(b=0;b<d.length;b++){if(!c.hasOwnProperty(d[b]))return void 0;c=c[d[b]]}return c},d.nextSlide=function(){k.busy||(k.busy=!0,clearInterval(k.play),r(1))},d.previousSlide=function(){k.busy||(k.busy=!0,clearInterval(k.play),r(-1))},d.goToSlide=function(a){k.busy||(k.busy=!0,clearInterval(k.play),s(a))},d.destroy=function(){k.initialized&&(k.initialized=!1,k.busy=!0,k.index.active=k.index.previous=1,clearInterval(k.play),e.unbind(".queueSlider"),void 0!==f.data("origStyle")?f.attr("style",f.data("origStyle")):f.removeAttr("style"),g.filter(".qs-clone").remove(),g.each(function(){void 0!==a(this).data("origStyle")?a(this).attr("style",a(this).data("origStyle")):a(this).removeAttr("style")}),g.children("img").fadeTo(0,1),l.buttons&&a(".qs-previous, .qs-next").remove(),a(window).unbind(".queueSlider"),k.busy=!1)},d.rebuild=function(b){void 0!==b&&(l=a.extend({},a.fn.queueSlider.defaults,b)),d.destroy(),m()},m(),d};a.fn.queueSlider=function(c){return this.each(function(){var d=a(this);if(d.data("queueslider"))return d.data("queueslider");var e=new b(this,c);d.data("queueslider",e)})},a.fn.queueSlider.defaults={alignMode:"center",fade:.3,transitionSpeed:700,speed:7e3,direction:1,offScreen:!1,autoHeight:!1,touchEnabled:!0,swipeThreshold:50,buttons:!0,previous:"Previous",next:"Next"}}(jQuery);